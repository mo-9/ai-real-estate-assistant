# Глобальный Roadmap: Польша, ЕС, СНГ, Россия, Турция, Африка, США

## Цели
- Единая платформа поиска недвижимости и аналитики для любых регионов
- Пользовательский режим (простой поиск, карта, сравнения, калькуляторы)
- Экспертный режим (индексы, компараблы, доходность, риски, экспорт)

## Архитектура данных
- Расширить `Property` и метаданные:
  - `country`, `region`, `city`, `district`, `lat`, `lon`
  - `currency`, `price_original`, `price_converted`, `price_per_sqm`
  - `listing_type` (rent/sale), `transaction_type`, `property_type`
  - опционально: `year_built`, `energy_cert`, `floor`, `amenities`
- Нормализация валют: PLN/EUR/USD/TRY/RUB/ZAR/…
  - Провайдеры курсов: ECB/NBP/Fed/…; кэширование (суточное)
- Геокодирование: batch через OpenStreetMap/Nominatim (rate‑limit), хранить lat/lon
- Хранение: отдельные коллекции Chroma per‑region, схема имени `properties_<country>`

## Интеграции данных
- Источники: CSV‑файлы, открытые датасеты (HuggingFace, гос.статистика), ручной импорт
- Агрегация по городам/районам, валидация/очистка, дедупликация
- Планировщик обновлений: инкрементальные дозагрузки, переиндексация по расписанию

## Поиск и ретривер
- Геопространственные фильтры: bounding box, радиус от точки
- Фасеты: `country/city/type/rooms/price_per_sqm` и др.
- Мультиязычная нормализация запросов (синонимы, translit)
- Реранкер: приоритеты пользователя (семья/инвестор), признаки локации/цены/площади

## Аналитика и индексы
- Индекс цен по городам/странам (медиана, средняя, YoY/YoM)
- Доходность аренды (gross/net yield), ROI, срок окупаемости
- Компараблы: похожие объекты + корректировка справедливой цены
- Риск‑метрики: волатильность, ликвидность, вакантность (если доступно)
- Таймсерии: сглаживание, тренды, аномалии

## Карта и визуализация
- Мировая карта: центровка по выбранной стране/городу, слои данных
- Тепловые карты цен и доходности, кластеры точек
- Фильтры на карте: цена/м², комнаты, тип, год, энергия

## UX/UI
- Быстрый поиск с понятными пресетами (семья/инвестор/офис)
- «Экспертный режим»: панели индексов, компараблы, экспорт PDF/CSV
- Локаль/валюта: выбор языка (EN/PL/RU/TR/AR/FR/DE/ES/IT/PT) и валюты
- Доступность: контраст, клавиатурная навигация, нейтральные состояния

## Уведомления и подписки
- Частный digest: новые объекты, снижение цен, топ‑5 вариантов
- Экспертный digest: индексы, тренды, лучшие локации по доходности
- Каналы: Email (есть), расширение шаблонов и критериев

## DevOps и качество
- Валидаторы данных: схемы/диапазоны/валидность координат
- Тесты: unit для аналитики, интеграция для ретривера, e2e UI
- Quality‑gates: ruff/mypy/bandit (включены в CI)

## Спринты
- Спринт 1 (1–2 недели)
  - Расширение схемы, валюты, lat/lon, коллекции per‑region
  - Гео‑фильтры, базовые индексы по Польше и ключевым городам ЕС
  - Карта с фильтрами, нейтральные состояния UI
  - Базовый digest (частный/экспертный)
- Спринт 2 (2–3 недели)
  - Индексы и компараблы для СНГ/Россия/Турция/США/Африка
  - Доходность/ROI, сценарии ставок и расходов
  - PRO‑фильтры (энергия/год/лифт/парковка), мультиязычные тексты
- Спринт 3 (3–4 недели)
  - Hedonic‑оценка справедливой цены и стратегический реранкер
  - Исторические слои карты, точки интереса, экспорт отчётов
  - Производительность/кэш/параллельные загрузки
- Спринт 4 (2 недели)
  - Уведомления/расписания/расширенные шаблоны
  - Полные e2e тесты, статические проверки, стабилизация

## Метрики успеха
- CTR «похожие объекты», конверсия в сохранённые поиски, открытие digest
- Точность компараблов и оценок (±%), активность на карте, время в приложении
