{
  "master": {
    "tasks": [
      {
        "id": "1",
        "title": "[TASK-001] API Platform & Security",
        "description": "Definition: Provide a secure, observable, versioned API surface where every response is traceable via X-Request-ID and secrets never reach the browser.\n\nSUBTASK [TASK-001.1] Settings and environment wiring\n- STEP [TASK-001.1.1] Normalize API access keys (rotation) and enforce dev/prod defaults.\n- STEP [TASK-001.1.2] Enforce production CORS allowlist and reject unsafe wildcard origins.\n- STEP [TASK-001.1.3] Bound risky inputs via settings (RAG sizes, sources truncation, timeouts).\n\nSUBTASK [TASK-001.2] Auth middleware and rate limiting\n- STEP [TASK-001.2.1] Validate X-API-Key against rotated keys and return 403 with safe detail.\n- STEP [TASK-001.2.2] Apply per-client RPM rate limiting with deterministic client ID derivation.\n- STEP [TASK-001.2.3] Ensure health and docs endpoints behave correctly under auth + rate limits.\n\nSUBTASK [TASK-001.3] Request correlation and error envelope\n- STEP [TASK-001.3.1] Generate/normalize X-Request-ID for every request and response.\n- STEP [TASK-001.3.2] Standardize error responses as { detail: string } with X-Request-ID.\n- STEP [TASK-001.3.3] Prevent logging of secrets; redact sensitive headers and tokens.\n\nSUBTASK [TASK-001.4] Next.js server proxy contract for /api/v1/*\n- STEP [TASK-001.4.1] Proxy requests to backend and inject server-side X-API-Key.\n- STEP [TASK-001.4.2] Strip client-supplied X-API-Key and cookies; forward only allowlisted headers.\n- STEP [TASK-001.4.3] Propagate X-Request-ID and preserve SSE streaming bodies end-to-end.",
        "status": "in-progress",
        "priority": "high",
        "subtasks": [
          {
            "id": 1.1,
            "title": "[TASK-001.1] Settings and environment wiring",
            "status": "done",
            "parentId": "1"
          },
          {
            "id": 1.2,
            "title": "[TASK-001.2] Auth middleware and rate limiting",
            "status": "pending",
            "parentId": "1"
          },
          {
            "id": 1.3,
            "title": "[TASK-001.3] Request correlation and error envelope",
            "status": "pending",
            "parentId": "1"
          },
          {
            "id": 1.4,
            "title": "[TASK-001.4] Next.js server proxy contract",
            "status": "pending",
            "parentId": "1"
          }
        ],
        "dependencies": [],
        "updatedAt": "2026-01-26T01:33:57.660Z"
      },
      {
        "id": "2",
        "title": "[TASK-002] Retrieval, Data, and Local RAG",
        "description": "Definition: Enable ingest/index/search of property and document data with deterministic results, bounded resource usage, and reliable citations.\n\nSUBTASK [TASK-002.1] Property data ingestion and normalization\n- STEP [TASK-002.1.1] Validate and normalize property schema (geo fields, currency, listing type).\n- STEP [TASK-002.1.2] Deduplicate records deterministically and enforce maximum dataset size.\n- STEP [TASK-002.1.3] Run ingest/reindex via admin endpoints with safe operational feedback.\n\nSUBTASK [TASK-002.2] Vector store abstraction and indexing\n- STEP [TASK-002.2.1] Index properties into Chroma with hybrid fields and metadata filters.\n- STEP [TASK-002.2.2] Provide managed option wiring (pgvector) without changing API contract.\n- STEP [TASK-002.2.3] Degrade gracefully when vector store is unavailable (predictable errors).\n\nSUBTASK [TASK-002.3] Search endpoint behavior (hybrid + geo + sort)\n- STEP [TASK-002.3.1] Implement POST /api/v1/search request/response models and validation.\n- STEP [TASK-002.3.2] Implement filters + geo (radius/bbox) + stable sort with clear tie-breakers.\n- STEP [TASK-002.3.3] Return explainability fields (match signals) without leaking prompts.\n\nSUBTASK [TASK-002.4] Local RAG knowledge base\n- STEP [TASK-002.4.1] Upload documents with per-file and total byte bounds.\n- STEP [TASK-002.4.2] Answer questions with citations and bounded top_k.\n- STEP [TASK-002.4.3] Reset knowledge base safely and idempotently.",
        "status": "pending",
        "priority": "high",
        "subtasks": [
          {
            "id": 2.1,
            "title": "[TASK-002.1] Property ingestion and normalization",
            "status": "pending",
            "parentId": "2"
          },
          {
            "id": 2.2,
            "title": "[TASK-002.2] Vector store abstraction and indexing",
            "status": "pending",
            "parentId": "2"
          },
          {
            "id": 2.3,
            "title": "[TASK-002.3] Search endpoint behavior",
            "status": "pending",
            "parentId": "2"
          },
          {
            "id": 2.4,
            "title": "[TASK-002.4] Local RAG knowledge base",
            "status": "pending",
            "parentId": "2"
          }
        ],
        "dependencies": [
          "1"
        ]
      },
      {
        "id": "3",
        "title": "[TASK-003] Chat & Tool Orchestration",
        "description": "Definition: Provide a streaming chat experience backed by tools and retrieval, with deterministic testing and safe fallbacks across LLM providers.\n\nSUBTASK [TASK-003.1] SSE chat contract and streaming reliability\n- STEP [TASK-003.1.1] Define typed SSE events and finalize response meta payload (sources, truncation flags).\n- STEP [TASK-003.1.2] Implement server-side streaming with timeouts and safe termination behavior.\n- STEP [TASK-003.1.3] Ensure the client can recover from stream errors with request correlation.\n\nSUBTASK [TASK-003.2] Tool registry and execution safety\n- STEP [TASK-003.2.1] Validate tool inputs and outputs with strict schemas (Python/Pydantic).\n- STEP [TASK-003.2.2] Stream intermediate tool steps without leaking sensitive data.\n- STEP [TASK-003.2.3] Implement deterministic tool stubs for Pro-only integrations.\n\nSUBTASK [TASK-003.3] Provider routing and per-user preferences\n- STEP [TASK-003.3.1] Route providers via provider factory with consistent config defaults.\n- STEP [TASK-003.3.2] Implement per-user model preferences and apply during chat/tool execution.\n- STEP [TASK-003.3.3] Surface local runtime availability and runtime errors safely.",
        "status": "pending",
        "priority": "high",
        "subtasks": [
          {
            "id": 3.1,
            "title": "[TASK-003.1] SSE contract and streaming reliability",
            "status": "pending",
            "parentId": "3"
          },
          {
            "id": 3.2,
            "title": "[TASK-003.2] Tool registry and execution safety",
            "status": "pending",
            "parentId": "3"
          },
          {
            "id": 3.3,
            "title": "[TASK-003.3] Provider routing and preferences",
            "status": "pending",
            "parentId": "3"
          }
        ],
        "dependencies": [
          "1",
          "2"
        ]
      },
      {
        "id": "4",
        "title": "[TASK-004] Frontend UI System (State-First)",
        "description": "Definition: Deliver a resilient Next.js UI that never blocks on missing data, always communicates loading, and provides recovery paths with request IDs.\n\nSUBTASK [TASK-004.1] Typed API client + uniform error handling\n- STEP [TASK-004.1.1] Keep TypeScript API contracts centralized and consistent across features.\n- STEP [TASK-004.1.2] Attach request_id to thrown errors when X-Request-ID exists.\n- STEP [TASK-004.1.3] Add unit tests for error parsing and header behavior.\n\nSUBTASK [TASK-004.2] Search page UI (4 mandated states)\n- STEP [TASK-004.2.1] Empty state (zero-data): onboarding copy + example queries + disabled export.\n- STEP [TASK-004.2.2] Loading state: skeleton results + disabled controls + map placeholder.\n- STEP [TASK-004.2.3] Error state: retry action + human-readable error + request_id=....\n- STEP [TASK-004.2.4] Populated state: results list + filters + sorting + map clustering.\n\nSUBTASK [TASK-004.3] Chat page UI (4 mandated states)\n- STEP [TASK-004.3.1] Empty state (zero-data): suggested prompts and explanation of tools/sources.\n- STEP [TASK-004.3.2] Loading state: streaming placeholder + thinking indicator.\n- STEP [TASK-004.3.3] Error state: inline assistant apology + retry + request_id=....\n- STEP [TASK-004.3.4] Populated state: message list + sources display + intermediate steps toggle.\n\nSUBTASK [TASK-004.4] Settings, Knowledge, Analytics pages (4 mandated states)\n- STEP [TASK-004.4.1] Empty state: clear guidance when settings/models/knowledge are absent.\n- STEP [TASK-004.4.2] Loading state: skeleton sections for model catalog and network calls.\n- STEP [TASK-004.4.3] Error state: retry actions + readable feedback + request_id=....\n- STEP [TASK-004.4.4] Populated state: editable preferences + runtime info + knowledge citations.",
        "status": "pending",
        "priority": "high",
        "subtasks": [
          {
            "id": 4.1,
            "title": "[TASK-004.1] Typed API client + error handling",
            "status": "pending",
            "parentId": "4"
          },
          {
            "id": 4.2,
            "title": "[TASK-004.2] Search UI states",
            "status": "pending",
            "parentId": "4"
          },
          {
            "id": 4.3,
            "title": "[TASK-004.3] Chat UI states",
            "status": "pending",
            "parentId": "4"
          },
          {
            "id": 4.4,
            "title": "[TASK-004.4] Settings/Knowledge/Analytics UI states",
            "status": "pending",
            "parentId": "4"
          }
        ],
        "dependencies": [
          "1",
          "2",
          "3"
        ]
      }
    ],
    "metadata": {
      "version": "1.0.0",
      "lastModified": "2026-01-26T01:33:57.661Z",
      "taskCount": 4,
      "completedCount": 0,
      "tags": [
        "master"
      ]
    }
  }
}